---
title: "DATA 589 Project"
author: "Christopher Mulya | Natalie Coutinho | Pranav Kumar Mahesh"
date: "2024-04-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Load required packages
suppressWarnings({
  library(sp)
  library(sf)
  library(spatstat)
  library(maptools)
})

# Import the BC Covariates dataset
suppressWarnings({
  load("BC_Covariates.Rda")
})

library(readxl)

# Read the Excel file
suppressWarnings({
  df <- read_excel("Moose_data.xlsx")
})

# Extract decimalLatitude and decimalLongitude columns
latitude_column <- df$decimalLatitude
longitude_column <- df$decimalLongitude
province <- df$stateProvince

# Create a new data frame with latitude and longitude columns
coordinates_df <- data.frame(province = province, latitude = latitude_column, longitude = longitude_column)

# Load the required library
suppressWarnings({
  library(dplyr)
})

# Filter coordinates_df to only include observations from British Columbia (BC)
coordinates <- coordinates_df %>%
  filter(province == "British Columbia" | province == "Bc" | province == "Canada - British Columbia (BC)")


coordinates <- na.omit(coordinates)

# Print the filtered data frame for verification
head(coordinates)
```

```{r}
# Identify the class of each element within the list
sapply(DATA, class)
```

```{r}
# Extracting each element from DATA
Forest <- DATA$Forest
Window <- DATA$Window
Elevation <- DATA$Elevation
HFI <- DATA$HFI
Dist_Water <- DATA$Dist_Water
```

```{r}
# Load the required library
library(sp)

# Create a SpatialPoints object from latitude and longitude coordinates
coordinates_sp <- SpatialPoints(coords = coordinates[, c("longitude", "latitude")], 
                                proj4string = CRS("+proj=longlat +datum=WGS84"))

# Define the BC Albers projection
bc_albers_proj <- CRS("+proj=aea +lat_0=45 +lon_0=-126 +lat_1=50 +lat_2=58.5 +x_0=1000000 +y_0=0 +datum=NAD83 +units=m +no_defs")

# Transform the coordinates to BC Albers projection
coordinates_bc_albers <- spTransform(coordinates_sp, bc_albers_proj)

# Plot the transformed coordinates
plot(coordinates_bc_albers, 
     xlab = "BC Albers Easting (m)", ylab = "BC Albers Northing (m)",
     main = "BC Albers Projection of Latitude and Longitude Coordinates")
```

```{r}
# Convert the Window object to an owin object
win <- as.owin(Window)

# Convert the data to a ppp object using the provided Window object
loc_ppp <- ppp(coordinates_bc_albers@coords[,1], coordinates_bc_albers@coords[,2], window = win)

# Plot the ppp object
plot(loc_ppp, main = "Spatial Distribution of Moose")
```

```{r}
# Plot latitude and longitude coordinates
plot(coordinates$longitude, coordinates$latitude, 
     xlab = "Longitude", ylab = "Latitude",
     main = "Scatter Plot of Latitude and Longitude")

```


```{r}
# Plot the owin object
plot(Window, main = "Observation Window")
```
```{r}
plot(Forest)
```

```{r}
plot(HFI)
```
```{r}
plot(Dist_Water)
```

